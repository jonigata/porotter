// leanModal v1.1 by Ray Stone - http://finelysliced.com.au
// Dual licensed under the MIT and GPL

(function($){
    $.fn.extend({
        leanModal: function(options){
            var defaults={
                top:100,
                overlay:0.5,
                closeButton:null,
                preopen:function(e) {}
            };
            var overlay = $("<div id='lean_overlay'></div>");
            $("body").append(overlay);
            options = $.extend(defaults,options);
            return this.each(function(){
                var o = options;
                $(this).click(function(e){
                    var modal = $($(this).attr("href"));
                    var close_modal_f = function() { close_modal(modal); };
                    overlay.click(close_modal_f);
                    $(o.closeButton).click(close_modal_f);
                    overlay.css({
                        "display":"block",
                        opacity:0
                    });
                    overlay.fadeTo(200,o.overlay);
                    modal.css({
                        "display":"block",
                        "position":"fixed",
                        "opacity":0,
                        "z-index":11000,
                        "left":50+"%",
                        "margin-left":-(modal.outerWidth()/2)+"px",
                        "top":o.top+"px"
                    });
                    modal.fadeTo(200,1);
                    o.preopen($(this));
                    e.preventDefault();
                });
            });
            function close_modal(modal){
                overlay.fadeOut(200);
                modal.css({"display":"none"});
            }}
    });
})(jQuery);
